# уязвимость/атака

## Описание
SSRF (server side request forgery) — это эксплойт, с помощью которого можно заставить уязвимое приложение сделать запрос на предоставленный URL. Так можно получить доступ к внутренним службам или данным, недоступным для обычного пользователя.

## Классификация
- Basic
Показывает ответ атакуещему
- Blind
Запрос выполняется, тело выполненого запроса атакующий не видит

## Условия
- ОС: любая
- язык: любая
- компоненты: библиотеки, инфраструктура сети
- настройки: разные

## Детектирование
Для детектирования можно использовать [BurpSuite](https://portswigger.net/burp) и ручное тестирование путем ввода различных URL представленных ниже.


## Эксплуатация
Внедрение GET запроса путем ввода ссылки на запрашиваемый ресурс


### Инструменты
- [localhost dns resolver](https://nip.io/)
- [BurpSuite](https://portswigger.net/burp)

## Ущерб
- Сканирование внутренней сети компании, например сканер портов.
- Обращение к внутренним ресурсам компании
- Исполнение произвольных HTTP GET-запросов

## Защита
### Основные меры
- Фильтровать DNS и локальные IP адреса
- Проверять схему в ссылке и работать только с HTTP/HTTPS

### Превентивные меры
- Ограничить доступ к внутренней инфраструктуре для потенциально подверженных SSRF серверов
- Вынести  функционал в отдельный изолированный сервис общий для всех команд

## Дополнительно
Источники:
- [pycurl and requests methods comparation](https://github.com/0xyd/Pycurl-vs-Requests)
- [PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Request%20Forgery/README.md)

## Обход защиты
Использование ASCII и UTF символов, сервисов подобных [nip.io](https://nip.io/), ipv6 адресов, ip адресов в других системах счисления, DNS серверов

## Примеры URL
- localhost
- 127.1
- 127.1:80
- customer2-app-127-0-0-1.nip.io
- 127.127.127.127
- 2130706433
- 0177.0.0.1
- [0:0:0:0:0:ffff:127.0.0.1]
- 127.0.1
- 0
- 127.*.*.*

## Примеры использования
Примеры сканера портов и фильтрации GET запросов приложены в папке app/